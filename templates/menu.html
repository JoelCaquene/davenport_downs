{% extends "base.html" %}
{% load static %}

{% block title %}Menu{% endblock %}

{% block content %}
<div class="main-content-container">

    {# ================================================ #}
    {# 1. Pop-up de Boas-Vindas (Mantido e Funcional) #}
    {# ================================================ #}
    <div id="welcomePopup" class="popup-overlay">
        <div class="popup-content">
            <div class="popup-header-custom">
                <i class="fas fa-bell popup-icon-main"></i>
                <h2 class="popup-title-custom">üì£ Avisos Importantes</h2>
            </div>
            <div class="popup-body-custom">
                
                {# Informa√ß√µes de Dep√≥sito #}
                <div class="info-card-popup">
                    <div class="info-icon"><i class="fas fa-money-bill-wave"></i></div>
                    <div class="info-text">
                        <h3>üè¶ Dep√≥sito</h3>
                        <ul>
                            <li>**M√≠nimo:** 5000 Kz</li>
                            <li>**Hor√°rio:** 08:30 at√© 20:00h</li>
                            <li>**Aten√ß√£o:** N√£o aceitamos dep√≥sito de bancos diferentes.</li>
                        </ul>
                    </div>
                </div>

                {# Informa√ß√µes de Equipa #}
                <div class="info-card-popup">
                    <div class="info-icon"><i class="fas fa-users"></i></div>
                    <div class="info-text">
                        <h3>ü§ù Equipa (Ganhos)</h3>
                        <ul>
                            <li>**B√≥nus Dep√≥sito:** Ganhas **15%** do dep√≥sito do seu subordinado (se tiver N√≠vel Ativo).</li>
                            <li>**B√≥nus Tarefa:** Ganhas **100 Kz** por cada tarefa realizada pelo seu subordinado.</li>
                            <li>**Regra:** Quanto mais subordinados tiveres, mais ganhas.</li>
                        </ul>
                    </div>
                </div>

                {# Informa√ß√µes de Saque #}
                <div class="info-card-popup">
                    <div class="info-icon"><i class="fas fa-wallet"></i></div>
                    <div class="info-text">
                        <h3>üí∞ Saque</h3>
                        <ul>
                            <li>**M√≠nimo:** 2500 Kz</li>
                            <li>**Taxa:** 10%</li>
                            <li>**Hor√°rio:** 09:00 at√© 17:00h</li>
                            <li>**Dias:** Segunda a Domingo.</li>
                            <li>**Dura√ß√£o:** 0 - 24 horas.</li>
                        </ul>
                    </div>
                </div>
                
            </div>
            <button id="closePopup" class="popup-close-button-custom">Continuar e Entender</button>
        </div>
    </div>
    
    {# ================================================ #}
    {# 2. Header (Nome Atualizado e Bot√£o Rolete da Sorte Girat√≥rio) #}
    {# ================================================ #}
    <header class="menu-header">
        <div class="header-content-wrapper">
            <h1 class="platform-name updated-name">DAVENPORT DOWNS</h1>
            {% if whatsapp_link %}
                <a href="{{ whatsapp_link }}" class="support-button">
                    <i class="fa-brands fa-whatsapp"></i>
                    <span>Apoio</span>
                </a>
            {% endif %}
        </div>
        
        {# NOVO: Bot√£o Roleta da Sorte no Header (No local do X) #}
        <a href="{% url 'roleta' %}" class="lucky-spin-button" title="Roleta da Sorte">
            <i class="fa-solid fa-gamepad lucky-spin-icon"></i>
        </a>
    </header>

    {# ================================================ #}
    {# 3. Cart√µes de Renda (Mantidos - 3 por Linha) #}
    {# ================================================ #}
    <div class="income-cards-container">
        <h2 class="income-cards-title">üìä CONTABILIDADE</h2>

        {# Linha 1: Dados Principais #}
        <div class="cards-grid">
            
            {# Card 1: Saldo Activo #}
            <div class="small-card card-balance">
                <i class="fa-solid fa-sack-dollar card-icon"></i>
                <p class="card-title">Saldo Activo</p>
                <span class="card-value">KZ {{ user.available_balance|default:"0.00" }}</span>
            </div>

            {# Card 2: N√≠vel Activo #}
            <div class="small-card card-level">
                <i class="fa-solid fa-star card-icon"></i>
                <p class="card-title">N√≠vel</p>
                <span class="card-value">{{ active_level.level.name|default:"Nenhum" }}</span>
            </div>

            {# Card 3: Dep√≥sito Activo #}
            <div class="small-card card-deposit">
                <i class="fa-solid fa-money-bill-trend-up card-icon"></i>
                <p class="card-title">Dep√≥sito Activo</p>
                <span class="card-value">KZ {{ approved_deposit_total|default:"0.00" }}</span>
            </div>
        </div>

        {# Linha 2: Dados de Renda e Retirada #}
        <div class="cards-grid">
            
            {# Card 4: Renda de Hoje #}
            <div class="small-card card-daily-income">
                <i class="fa-solid fa-chart-line card-icon"></i>
                <p class="card-title">Renda de Hoje</p>
                <span class="card-value">KZ {{ daily_income|default:"0.00" }}</span>
            </div>
            
            {# Card 5: Ganho de Subs√≠dio #}
            <div class="small-card card-subsidy">
                <i class="fa-solid fa-users card-icon"></i>
                <p class="card-title">Subs√≠dio</p>
                <span class="card-value">KZ {{ user.subsidy_balance|default:"0.00" }}</span>
            </div>

            {# Card 6: Total Sacado #}
            <div class="small-card card-withdrawals">
                <i class="fa-solid fa-hand-holding-dollar card-icon"></i>
                <p class="card-title">Total Sacado</p>
                <span class="card-value">KZ {{ total_withdrawals|default:"0.00" }}</span>
            </div>
        </div>
        
    </div>
    
    {# ================================================ #}
    {# 4. Bloco de Informa√ß√µes (Cards Grandes) #}
    {# ================================================ #}
    <div class="info-cards-section">
        
        {# Card 1: O que √©? (Vis√£o Geral) #}
        <div class="info-card custom-card-1">
            <img src="{% static 'images/about_us_icon.png' %}" alt="O que √© imagem" class="card-large-image">
            <div class="card-header">
                <img src="{% static 'images/about_us_icon.png' %}" alt="O que √© √≠cone" class="card-image-icon-small">
                <h2>üêÆ Davenport Downs: O que √©?</h2>
            </div>
            <p>
                **Davenport Downs** √© uma das maiores **fazendas de gado** (*cattle station*) do mundo, localizada no **Channel Country** em Queensland, **Austr√°lia**.
            </p>
            <p>
                Cobre cerca de **1,4 milh√£o de hectares** e √© reconhecida pela sua gigantesca escala, mantendo mais de **29.000 cabe√ßas de gado**.
            </p>
            <span class="card-tag">Maior Fazenda de Gado da Austr√°lia</span>
        </div>
        
        {# Card 2: Qual √© o Objetivo? #}
        <div class="info-card custom-card-2">
            <img src="{% static 'images/goal_icon.png' %}" alt="Objetivo imagem" class="card-large-image">
            <div class="card-header">
                <img src="{% static 'images/goal_icon.png' %}" alt="Objetivo √≠cone" class="card-image-icon-small">
                <h2>üéØ Qual √© o Objetivo?</h2>
            </div>
            <ul>
                <li>O principal foco √© a **efici√™ncia pecu√°ria** e a produ√ß√£o de **carne de alta qualidade**.</li>
                <li>Implementa√ß√£o de tecnologias avan√ßadas para **sustentabilidade** e manejo otimizado de pastagens.</li>
                <li>Inclui a gera√ß√£o de receita via **Agroturismo** e preserva√ß√£o ambiental.</li>
            </ul>
            <span class="card-tag">Tecnologia e Sustentabilidade</span>
        </div>
        
        {# Card 3: Quais s√£o as Conquistas? #}
        <div class="info-card custom-card-3">
            <img src="{% static 'images/achievement_icon.png' %}" alt="Conquistas imagem" class="card-large-image">
            <div class="card-header">
                <img src="{% static 'images/achievement_icon.png' %}" alt="Conquistas √≠cone" class="card-image-icon-small">
                <h2>üèÖ Conquistas Chave</h2>
            </div>
            <ul>
                <li>**Relev√¢ncia Global:** Consolidada como uma das opera√ß√µes pecu√°rias mais eficientes do mundo.</li>
                <li>**Conserva√ß√£o:** Modelo de manejo regenerativo e prote√ß√£o da fauna (Ex: Bilbies).</li>
                <li>**Impacto Social:** Contribui√ß√£o significativa para a economia regional e **capacita√ß√£o de ind√≠genas**.</li>
            </ul>
            <span class="card-tag">Resili√™ncia e Inova√ß√£o</span>
        </div>

    </div>
    
    {# NOVO: Imagem da Fazenda/Vaca (Transferida para o fim do conte√∫do principal) #}
    <div class="farm-image-container">
        <img src="{% static 'images/farm_main.png' %}" alt="Imagem da Fazenda Davenport Downs com vacas" class="farm-main-image">
    </div>
    
</div>

{# ================================================ #}
{# 5. Barra de Navega√ß√£o Inferior (Fixed Footer) #}
{# ================================================ #}
<nav class="footer-nav">
    {# Dep√≥sito #}
    <a href="{% url 'deposito' %}" class="footer-item">
        <i class="fa-solid fa-money-bill-transfer"></i>
        <span>Dep√≥sito</span>
    </a>
    {# Saque #}
    <a href="{% url 'saque' %}" class="footer-item">
        <i class="fa-solid fa-piggy-bank"></i>
        <span>Saque</span>
    </a>
    {# Tarefa #}
    <a href="{% url 'tarefa' %}" class="footer-item">
        <i class="fa-solid fa-list-check"></i>
        <span>Tarefa</span>
    </a>
    {# NOVO: Roleta da Sorte #}
    <a href="{% url 'roleta' %}" class="footer-item">
        <i class="fa-solid fa-gamepad"></i>
        <span>Roleta</span>
    </a>
    {# Perfil #}
    <a href="{% url 'perfil' %}" class="footer-item">
        <i class="fa-solid fa-user-astronaut"></i>
        <span>Meu</span>
    </a>
</nav>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        // L√≥gica do Pop-up de Boas-Vindas (Mantida)
        const popup = document.getElementById('welcomePopup');
        const closeButton = document.getElementById('closePopup');

        // Exibe o pop-up a cada carregamento da p√°gina.
        popup.style.display = 'flex';

        // Adiciona evento para fechar
        closeButton.addEventListener('click', () => {
            popup.style.display = 'none';
        });

        // Opcional: fechar ao clicar fora do pop-up
        window.addEventListener('click', (event) => {
            if (event.target === popup) {
                popup.style.display = 'none';
            }
        });
    });
</script>

<style>
    /* ================================================
    ESTILOS GLOBAIS - TEMA BRANCO
    ================================================ */
    html, body {
        height: 100%;
        margin: 0;
        padding-bottom: 60px; /* Espa√ßo para o footer fixo */
        font-family: 'Arial', sans-serif;
    }
    
    body {
        background-color: #f7f9fc !important;
        color: #333 !important;
    }

    .main-content-container {
        padding-bottom: 15px; /* Pequeno padding para o final do conte√∫do */
        margin-bottom: 0;
    }

    /* ================================================
    ESTILOS DO HEADER
    ================================================ */
    .menu-header {
        background-color: #ffffff;
        color: #0d1a2f;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        padding: 10px 15px;
        position: sticky;
        top: 0;
        z-index: 50;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .header-content-wrapper {
        display: flex;
        align-items: center;
        flex-grow: 1; /* Permite que o wrapper ocupe o espa√ßo necess√°rio */
        justify-content: space-between;
    }

    .platform-name.updated-name {
        font-family: 'Times New Roman', serif;
        font-size: 1.6rem;
        font-weight: 800;
        letter-spacing: 2px;
        color: #0d1a2f;
        text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);
        margin-right: 10px;
    }

    .support-button {
        color: #ffffff;
        background-color: #4CAF50;
        border: none;
        padding: 5px 10px;
        border-radius: 5px;
        text-decoration: none;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        display: flex;
        align-items: center;
        gap: 5px;
        font-weight: 600;
        flex-shrink: 0; /* N√£o permite encolher */
    }

    /* NOVO: Bot√£o Girat√≥rio da Roleta da Sorte no Header */
    .lucky-spin-button {
        background-color: #FFC300; /* Destaque amarelo para chamar aten√ß√£o */
        border: 2px solid #FF5733; /* Borda laranja/vermelha */
        border-radius: 50%; /* Torna-o redondo */
        width: 40px;
        height: 40px;
        display: flex;
        justify-content: center;
        align-items: center;
        box-shadow: 0 0 10px rgba(255, 195, 0, 0.7);
        flex-shrink: 0;
        margin-left: 15px; /* Espa√ßo entre o bot√£o de Apoio e a Roleta */
        text-decoration: none;
    }
    
    .lucky-spin-icon {
        color: #0d1a2f;
        font-size: 1.5rem;
        /* Anima√ß√£o de rota√ß√£o */
        animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    /* FIM: Bot√£o Roleta da Sorte */

    /* ================================================
    ESTILOS POP-UP (Mantido)
    ================================================ */
    /* ... (Estilos do Pop-up mantidos) ... */
    .popup-overlay {
        background-color: rgba(0, 0, 0, 0.7);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 2000;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }

    .popup-content {
        background-color: #ffffff;
        color: #333;
        width: 90%;
        max-width: 380px;
        height: 80vh;
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        border: 4px solid #4CAF50;
    }

    .popup-body-custom {
        padding: 15px;
        overflow-y: auto;
        flex-grow: 1;
    }

    .popup-header-custom {
        background-color: #4CAF50;
        color: white;
        padding: 15px;
        text-align: center;
        border-radius: 8px 8px 0 0;
        flex-shrink: 0;
    }
    
    .popup-close-button-custom {
        background-color: #0d1a2f;
        color: white;
        border: none;
        padding: 12px;
        font-size: 1rem;
        cursor: pointer;
        transition: background-color 0.3s;
        flex-shrink: 0;
    }
    
    /* Estilos dos Cards de Informa√ß√£o no Pop-up (Mantido) */
    .info-card-popup {
        display: flex;
        align-items: flex-start;
        margin-bottom: 15px;
        padding: 10px;
        border-radius: 8px;
        background-color: #f0f0f0;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .info-icon {
        color: #0d1a2f;
        font-size: 1.5rem;
        margin-right: 10px;
        padding-top: 5px;
    }

    .info-text h3 {
        margin: 0 0 5px 0;
        font-size: 1rem;
        color: #4CAF50;
        border-bottom: 1px solid #ccc;
        padding-bottom: 3px;
    }
    
    .info-text ul {
        list-style: none;
        padding: 0;
        margin: 0;
        font-size: 0.85rem;
    }
    
    .info-text li {
        margin-bottom: 3px;
        color: #555;
    }


    /* ================================================
    ESTILOS DOS NOVOS CART√ïES DE RENDA (Mantidos)
    ================================================ */
    .income-cards-container {
        padding: 15px;
    }
    
    .income-cards-title {
        font-size: 1.3rem;
        color: #0d1a2f;
        border-bottom: 3px solid #ccc;
        padding-bottom: 8px;
        margin-bottom: 15px;
        text-align: center;
        font-weight: 700;
    }

    .cards-grid {
        display: flex;
        justify-content: space-between;
        gap: 8px;
        margin-bottom: 15px;
    }
    
    .small-card {
        flex: 1 1 calc(33.33% - 8px);
        background-color: #ffffff;
        border-radius: 10px;
        padding: 10px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        text-align: center;
        border-bottom: 3px solid #4CAF50;
    }

    .card-icon {
        font-size: 1.5rem;
        color: #0d1a2f;
        margin-bottom: 5px;
    }

    .card-title {
        font-size: 0.75rem;
        color: #888;
        margin: 0 0 3px 0;
        font-weight: 600;
        text-transform: uppercase;
    }

    .card-value {
        font-size: 0.9rem;
        font-weight: 800;
        color: #4CAF50;
        display: block;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    /* Cores de destaque personalizadas */
    .card-balance .card-value { color: #0d1a2f; }
    .card-level .card-value { color: #FFC300; }
    .card-daily-income .card-value { color: #34A853; }
    .card-withdrawals .card-value { color: #EA4335; }
    
    /* REMOVIDO: Estilos do .action-button-main */
    .action-button-main {
        display: none !important;
    }

    /* ================================================
    ESTILOS DO BLOCO DE INFORMA√á√ïES (Cards Grandes)
    ================================================ */
    .info-cards-section {
        padding: 15px;
        display: flex;
        flex-direction: column;
        gap: 15px;
    }

    .info-card {
        background-color: #ffffff;
        border-radius: 12px;
        padding: 0 15px 15px 15px;
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s, box-shadow 0.3s;
        border-left: 5px solid;
    }

    .info-card .card-large-image {
        width: calc(100% + 30px);
        height: 200px;
        object-fit: cover;
        margin: 0 -15px 15px -15px;
        border-radius: 12px 12px 0 0;
    }
    
    .card-image-icon-small {
        width: 30px;
        height: 30px;
        margin-right: 10px;
        filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.2));
    }
    
    .card-header {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
        padding-top: 5px;
    }
    
    .info-card h2 {
        font-size: 1.1rem;
        margin: 0;
        font-weight: 700;
        color: #0d1a2f;
    }
    
    .info-card p, .info-card li {
        font-size: 0.9rem;
        line-height: 1.5;
        color: #555;
        margin-bottom: 8px;
    }
    
    .info-card ul {
        list-style-type: none;
        padding-left: 0;
    }
    
    .info-card ul li:before {
        content: "‚Ä¢";
        color: #4CAF50;
        font-weight: bold;
        display: inline-block;
        width: 1em;
        margin-left: -1em;
    }
    
    .card-tag {
        display: inline-block;
        margin-top: 10px;
        padding: 3px 8px;
        border-radius: 5px;
        font-size: 0.75rem;
        font-weight: 600;
        color: #fff;
    }
    
    /* Cores personalizadas para cada Card */
    .custom-card-1 { border-left-color: #87CEEB; }
    .custom-card-1 .card-tag { background-color: #87CEEB; }

    .custom-card-2 { border-left-color: #4CAF50; }
    .custom-card-2 .card-tag { background-color: #4CAF50; }
    .custom-card-2 h2 { color: #4CAF50; }

    .custom-card-3 { border-left-color: #FFC300; }
    .custom-card-3 .card-tag { background-color: #FFC300; }
    .custom-card-3 h2 { color: #FFC300; }
    
    /* NOVO: Estilos da Imagem da Fazenda/Vaca */
    .farm-image-container {
        padding: 0 15px 15px 15px;
    }

    .farm-main-image {
        width: 100%;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }
    /* FIM: Estilos da Imagem da Fazenda/Vaca */


    /* ================================================
    ESTILOS DA BARRA DE NAVEGA√á√ÉO INFERIOR (Fixed Footer)
    ================================================ */
    .footer-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 60px;
        background-color: #ffffff;
        box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
        display: flex;
        justify-content: space-around;
        align-items: center;
        z-index: 100;
    }

    .footer-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        text-decoration: none;
        color: #555;
        padding: 5px;
        transition: color 0.3s, transform 0.1s;
        flex-grow: 1;
    }

    .footer-item i {
        font-size: 1.4rem;
        margin-bottom: 2px;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }
    
    /* Destaque para Dep√≥sito */
    .footer-item[href*="deposito"] i {
        color: #4CAF50; 
    }
    
    /* Destaque para Roleta da Sorte */
    .footer-item[href*="roleta"] i {
        color: #FFC300; 
    }


    .footer-item span {
        font-size: 0.7rem;
        font-weight: 600;
    }

    .footer-item:hover, .footer-item.active {
        color: #4CAF50;
        transform: scale(1.05);
    }
    
    /* Oculta o footer Django padr√£o */
    footer {
        display: none !important;
    }
</style>
{% endblock %}
